{% extends 'base.html' %}
{% load static %}

{% block title %}
  {{ user.get_full_name }}
{% endblock %}

{% block scripts %}
  <script type="text/javascript" src="{% static 'js/user_follow.js' %}" defer></script>
{% endblock %}

{% block content %}
  {% if request.user == user %}
    <h1>{{ user.get_full_name }} (You)</h1>
  {% else %}
    <h1>{{ user.get_full_name }}</h1>
  {% endif %}
  <div class="profile-info">
    <img src="{{ user.profile.photo.url }}" alt="" class="cloudinary-user-detail" />
  </div>

  {% with total_followers=user.followers.count %}
    <span class="count"><span class="total">{{ total_followers }} follower{{ total_followers|pluralize }}</span></span>
    {% if request.user == user %}

    {% else %}
      <a href="#" data-id="{{ user.id }}" data-action="{% if request.user in user.followers.all %}un{% endif %}follow" class="follow button">
        {% if request.user not in user.followers.all %}
          Follow
        {% else %}
          Unfollow
        {% endif %}
      </a>
    {% endif %}
    <h2>Images uploaded by {{ user.first_name }}</h2>
    <div id="image-list" class="image-container">
      {% include 'images/list_images.html' with images=user.images_created.all %}
    </div>
  {% endwith %}
{% endblock %}
